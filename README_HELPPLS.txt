1.нужно обновить ту часть кода где мы " # Проходим по всем абзацам в основном документе " 
где мы будем находить цифры в файле template_path по следующей логике, если перед каким либо маркером в предыдущей строке стоит заголовок, то мы должны запомнить число с которого начинается этот заголовок.
и записать это в словарь  "наименвание маркера"-"номер с которого начинается заголовок перед этим маркером"
2. Во время обработки текста в основном документе (input_folder), текст который мы вставляем на место маркера (в функции def replace_markers_in_paragraph(paragraph, data):) 
должен с помощью перебора находить какие строки этого текста начинаются с числа, далее числа заменятся советующему числу из словаря для хранения который мы делаем в первом пункте
я думаю нужно это вставить после :# Создаем новый `Run` с заменённым текстом и применяем форматирование 
и до того как к нему применится фомратирование

3. Еще надо чтоб переносило таблички и изображения, у меня это получилось реализовать только в отдельном коде testing_pic+tables.py , в нем изображение не сохраняют своего местопложения,
а переносятся в самый конец, и а таблицы работают корректно, но нужно будет прорписать какие из них мы учитываем а какие нет относительно обрабатываемых секций между заголовками.Ы